# ğŸŒ MySQLæ…¢æŸ¥è¯¢åˆ†æç³»ç»Ÿ

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python Version](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![Flask Version](https://img.shields.io/badge/flask-2.3.3-green.svg)](https://flask.palletsprojects.com/)

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„MySQLæ…¢æŸ¥è¯¢æ—¥å¿—åˆ†æç³»ç»Ÿï¼Œå¸®åŠ©æ•°æ®åº“ç®¡ç†å‘˜å¿«é€Ÿå®šä½æ€§èƒ½ç“¶é¢ˆï¼Œä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸš€ é«˜æ€§èƒ½è§£æ
- **æ™ºèƒ½è§£æå™¨**: ç»è¿‡ä¼˜åŒ–çš„MySQLæ…¢æŸ¥è¯¢æ—¥å¿—è§£æå¼•æ“
- **æ‰¹é‡å¤„ç†**: æ”¯æŒå¤§æ–‡ä»¶çš„é«˜æ•ˆæ‰¹é‡è§£æ
- **å†…å­˜ä¼˜åŒ–**: 74.8%ä»£ç ç²¾ç®€ï¼Œå†…å­˜ä½¿ç”¨æ›´å°‘

### ğŸ“Š å¯è§†åŒ–åˆ†æ
- **ç»Ÿè®¡å›¾è¡¨**: ç›´è§‚çš„æŸ¥è¯¢æ—¶é—´åˆ†å¸ƒå’Œè¶‹åŠ¿å›¾
- **æ€§èƒ½æŒ‡æ ‡**: æ‰§è¡Œæ—¶é—´ã€æ‰«æè¡Œæ•°ã€è¿”å›è¡Œæ•°ç­‰å…³é”®æŒ‡æ ‡
- **SQLæŒ‡çº¹**: è‡ªåŠ¨ç”ŸæˆSQLæŒ‡çº¹ï¼Œè¯†åˆ«ç›¸ä¼¼æŸ¥è¯¢

### ğŸ” æ™ºèƒ½è¿‡æ»¤
- **æ—¶é—´èŒƒå›´**: æ”¯æŒè‡ªå®šä¹‰æ—¶é—´æ®µåˆ†æ
- **ç”¨æˆ·é»‘åå•**: è¿‡æ»¤ç³»ç»Ÿç”¨æˆ·ï¼ˆå¦‚pmm_user, rootç­‰ï¼‰
- **æ€§èƒ½é˜ˆå€¼**: æŒ‰æ‰§è¡Œæ—¶é—´ã€æ‰«æè¡Œæ•°ç­‰æ¡ä»¶ç­›é€‰

### ğŸ‘¥ ç”¨æˆ·ç®¡ç†
- **JWTè®¤è¯**: å®‰å…¨çš„ç”¨æˆ·è®¤è¯æœºåˆ¶
- **æƒé™æ§åˆ¶**: å¤šçº§ç”¨æˆ·æƒé™ç®¡ç†
- **ä¼šè¯ç®¡ç†**: è‡ªåŠ¨ä¼šè¯è¿‡æœŸå’Œç»­æœŸ

### ğŸ› ï¸ è¿ç»´å‹å¥½
- **ä¸€é”®éƒ¨ç½²**: å®Œæ•´çš„è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬
- **å¥åº·ç›‘æ§**: å®æ—¶ç³»ç»ŸçŠ¶æ€ç›‘æ§
- **æ—¥å¿—ç®¡ç†**: å®Œå–„çš„æ—¥å¿—è®°å½•å’Œè½®è½¬

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ (Vue.js)  â”‚    â”‚  Nginx åå‘ä»£ç†  â”‚    â”‚  MySQL æ•°æ®åº“   â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ - Element UI    â”‚â—„â”€â”€â–ºâ”‚ - é™æ€æ–‡ä»¶æœåŠ¡   â”‚    â”‚ - æ…¢æŸ¥è¯¢å­˜å‚¨     â”‚
â”‚ - å›¾è¡¨å¯è§†åŒ–     â”‚    â”‚ - APIä»£ç†       â”‚    â”‚ - ç”¨æˆ·æ•°æ®       â”‚
â”‚ - å“åº”å¼è®¾è®¡     â”‚    â”‚ - è´Ÿè½½å‡è¡¡       â”‚    â”‚ - æƒé™ç®¡ç†       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ åç«¯ (Flask)     â”‚
                        â”‚                 â”‚
                        â”‚ - RESTful API   â”‚
                        â”‚ - JWTè®¤è¯       â”‚
                        â”‚ - æ—¥å¿—è§£æ       â”‚
                        â”‚ - ä¸šåŠ¡é€»è¾‘       â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ éƒ¨ç½²å±‚           â”‚
                        â”‚                 â”‚
                        â”‚ - Gunicorn      â”‚
                        â”‚ - Supervisor    â”‚
                        â”‚ - è¿›ç¨‹ç®¡ç†       â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆè¯¦æƒ…

**åç«¯æŠ€æœ¯**
- **Python 3.8+**: ä¸»è¦å¼€å‘è¯­è¨€
- **Flask 2.3.3**: Webæ¡†æ¶
- **PyJWT**: JWTè®¤è¯
- **mysql-connector-python**: æ•°æ®åº“è¿æ¥
- **Gunicorn**: WSGIæœåŠ¡å™¨

**å‰ç«¯æŠ€æœ¯**
- **Vue.js**: å‰ç«¯æ¡†æ¶
- **Element UI**: UIç»„ä»¶åº“
- **ECharts**: å›¾è¡¨å¯è§†åŒ–
- **Axios**: HTTPå®¢æˆ·ç«¯

**éƒ¨ç½²æŠ€æœ¯**
- **Nginx**: WebæœåŠ¡å™¨å’Œåå‘ä»£ç†
- **Supervisor**: è¿›ç¨‹ç®¡ç†
- **MySQL 8.0+**: æ•°æ®å­˜å‚¨

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼ˆæ¨èï¼‰

```bash
# ä¸‹è½½éƒ¨ç½²è„šæœ¬
wget https://raw.githubusercontent.com/your-username/slowquery-reviewer/main/quick_deploy.sh

# è¿è¡Œè‡ªåŠ¨éƒ¨ç½²
sudo bash quick_deploy.sh
```

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

#### 1. ç¯å¢ƒè¦æ±‚
```bash
# ç³»ç»Ÿè¦æ±‚
- Ubuntu 20.04 LTS / CentOS 7+
- Python 3.8+
- MySQL 8.0+
- Nginx 1.18+
- 4GB+ å†…å­˜ï¼Œ50GB+ ç£ç›˜ç©ºé—´
```

#### 2. å…‹éš†ä»£ç 
```bash
git clone https://github.com/your-username/slowquery-reviewer.git
cd slowquery-reviewer
```

#### 3. å®‰è£…ä¾èµ–
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# å®‰è£…Pythonä¾èµ–
pip install -r backend/requirements.txt
```

#### 4. é…ç½®æ•°æ®åº“
```bash
# åˆ›å»ºæ•°æ®åº“
mysql -u root -p -e "CREATE DATABASE slow_query_analysis;"

# åˆå§‹åŒ–è¡¨ç»“æ„
python backend/init_database.py
python backend/init_tables.py
python backend/init_admin.py
```

#### 5. é…ç½®ç¯å¢ƒå˜é‡
```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶
cp backend/.env.example backend/.env

# ç¼–è¾‘é…ç½®
vim backend/.env
```

#### 6. å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨åç«¯
cd backend
gunicorn -c gunicorn.conf.py app:app

# é…ç½®Nginxï¼ˆå‚è€ƒnginx-production.confï¼‰
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. è®¿é—®ç³»ç»Ÿ
```
URL: http://your-server-ip
é»˜è®¤è´¦å·: admin
é»˜è®¤å¯†ç : admin
```

### 2. ä¸Šä¼ æ…¢æŸ¥è¯¢æ—¥å¿—
- ç‚¹å‡»"ä¸Šä¼ æ—¥å¿—"æŒ‰é’®
- é€‰æ‹©MySQLæ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶
- ç­‰å¾…è§£æå®Œæˆ

### 3. æŸ¥çœ‹åˆ†æç»“æœ
- **æ¦‚è§ˆé¡µé¢**: æŸ¥çœ‹æ•´ä½“ç»Ÿè®¡ä¿¡æ¯
- **è¯¦ç»†åˆ—è¡¨**: æŸ¥çœ‹æ¯æ¡æ…¢æŸ¥è¯¢è¯¦æƒ…
- **å›¾è¡¨åˆ†æ**: æŸ¥çœ‹æ€§èƒ½è¶‹åŠ¿å›¾è¡¨
- **SQLä¼˜åŒ–**: è·å–ä¼˜åŒ–å»ºè®®

## ğŸ“Š åŠŸèƒ½æˆªå›¾

### ä¸»è¦ç•Œé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ  æ…¢æŸ¥è¯¢åˆ†æç³»ç»Ÿ                    ğŸ‘¤ admin â–¼  ğŸšª é€€å‡º    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š æ¦‚è§ˆ  ğŸ“‹ æŸ¥è¯¢åˆ—è¡¨  ğŸ“ˆ ç»Ÿè®¡å›¾è¡¨  âš™ï¸ è®¾ç½®                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ“ˆ æ€»æŸ¥è¯¢æ•°: 1,234    â±ï¸ å¹³å‡æ‰§è¡Œæ—¶é—´: 2.5s                â”‚
â”‚  ğŸŒ æœ€æ…¢æŸ¥è¯¢: 45.2s    ğŸ“Š ä»Šæ—¥æ–°å¢: 89æ¡                    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ æ‰§è¡Œæ—¶é—´åˆ†å¸ƒ â”‚  â”‚ æŸ¥è¯¢é¢‘ç‡ç»Ÿè®¡ â”‚  â”‚ æ•°æ®åº“åˆ†å¸ƒ   â”‚          â”‚
â”‚  â”‚ [å›¾è¡¨åŒºåŸŸ]  â”‚  â”‚ [å›¾è¡¨åŒºåŸŸ]  â”‚  â”‚ [å›¾è¡¨åŒºåŸŸ]  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                             â”‚
â”‚  ğŸ” æœ€æ–°æ…¢æŸ¥è¯¢                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ SELECT * FROM users WHERE ... â”‚ 12.3s â”‚ 2024-09-15 ... â”‚â”‚
â”‚  â”‚ UPDATE orders SET status = ...â”‚  8.7s â”‚ 2024-09-15 ... â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ è¿ç»´ç®¡ç†

### ä½¿ç”¨ç®¡ç†è„šæœ¬
```bash
# æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
./manage.sh status

# å¯åŠ¨æœåŠ¡
./manage.sh start

# åœæ­¢æœåŠ¡
./manage.sh stop

# é‡å¯æœåŠ¡
./manage.sh restart

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
./manage.sh logs

# å¤‡ä»½æ•°æ®åº“
./manage.sh backup

# æ¢å¤æ•°æ®åº“
./manage.sh restore

# å¥åº·æ£€æŸ¥
./manage.sh health

# æ¸…ç†æ—¥å¿—
./manage.sh cleanup

# ç”¨æˆ·ç®¡ç†
./manage.sh user
```

### ç›‘æ§å’Œå‘Šè­¦
```bash
# ç³»ç»ŸçŠ¶æ€æ£€æŸ¥
curl http://localhost:5172/api/status

# æŸ¥çœ‹æœåŠ¡è¿›ç¨‹
ps aux | grep -E "(gunicorn|nginx)"

# æŸ¥çœ‹èµ„æºä½¿ç”¨
top -p $(pgrep -f gunicorn | tr '\n' ',' | sed 's/,$//')
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–
```sql
-- æ…¢æŸ¥è¯¢æ—¥å¿—é…ç½®
SET GLOBAL slow_query_log = 'ON';
SET GLOBAL long_query_time = 1;
SET GLOBAL slow_query_log_file = '/var/log/mysql/mysql-slow.log';

-- ç´¢å¼•ä¼˜åŒ–
CREATE INDEX idx_fingerprint_checksum ON slow_query_fingerprint(checksum);
CREATE INDEX idx_detail_timestamp ON slow_query_detail(timestamp);
```

### åº”ç”¨ä¼˜åŒ–
```bash
# è°ƒæ•´Gunicornå·¥ä½œè¿›ç¨‹æ•°
# gunicorn.conf.py
workers = CPUæ ¸å¿ƒæ•° Ã— 2 + 1

# ä¼˜åŒ–æ•°æ®åº“è¿æ¥æ± 
# config.py
DB_POOL_SIZE = 15
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_USER=slowquery
DB_PASSWORD=your_secure_password
DB_NAME=slow_query_analysis
DB_POOL_SIZE=15

# JWTé…ç½®
JWT_SECRET_KEY=your-super-secret-jwt-key
JWT_ACCESS_TOKEN_EXPIRES=86400

# åº”ç”¨é…ç½®
FLASK_ENV=production
FLASK_DEBUG=false
```

### Nginxé…ç½®
```nginx
# å…³é”®é…ç½®é¡¹
upstream backend {
    server 127.0.0.1:5172;
}

server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        root /opt/slowquery-reviewer/frontend/dist;
        try_files $uri $uri/ /index.html;
    }
    
    location /api/ {
        proxy_pass http://backend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

## ğŸš¨ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

**1. åç«¯æœåŠ¡å¯åŠ¨å¤±è´¥**
```bash
# æ£€æŸ¥æ—¥å¿—
tail -f /var/log/slowquery/backend.log

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep 5172

# æ‰‹åŠ¨å¯åŠ¨æµ‹è¯•
cd backend && python app.py
```

**2. æ•°æ®åº“è¿æ¥å¤±è´¥**
```bash
# æµ‹è¯•è¿æ¥
mysql -h localhost -u slowquery -p slow_query_analysis

# æ£€æŸ¥æƒé™
SHOW GRANTS FOR 'slowquery'@'localhost';
```

**3. å‰ç«¯é¡µé¢æ— æ³•è®¿é—®**
```bash
# æ£€æŸ¥NginxçŠ¶æ€
systemctl status nginx

# æ£€æŸ¥é…ç½®è¯­æ³•
nginx -t

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f /var/log/nginx/error.log
```

## ğŸ“š APIæ–‡æ¡£

### è®¤è¯æ¥å£
```http
POST /api/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin"
}
```

### æ…¢æŸ¥è¯¢æ¥å£
```http
GET /api/slow-queries?page=1&limit=20&start_time=2024-01-01&end_time=2024-12-31
Authorization: Bearer <token>
```

### ç»Ÿè®¡æ¥å£
```http
GET /api/statistics/summary
Authorization: Bearer <token>
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘ç¯å¢ƒè®¾ç½®
```bash
# å…‹éš†ä»£ç 
git clone https://github.com/your-username/slowquery-reviewer.git
cd slowquery-reviewer

# å®‰è£…å¼€å‘ä¾èµ–
pip install -r backend/requirements-dev.txt

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
cd backend && python app.py
```

### æäº¤è§„èŒƒ
```bash
# æäº¤æ ¼å¼
git commit -m "ç±»å‹(èŒƒå›´): æè¿°

è¯¦ç»†è¯´æ˜"

# ç±»å‹è¯´æ˜
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MITè®¸å¯è¯](LICENSE)

## ğŸ†˜ æ”¯æŒ

- **GitHub Issues**: [æäº¤é—®é¢˜](https://github.com/your-username/slowquery-reviewer/issues)
- **æ–‡æ¡£**: [æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£](PRODUCTION_DEPLOYMENT.md)
- **ç¤¾åŒº**: [åŠ å…¥è®¨è®º](https://github.com/your-username/slowquery-reviewer/discussions)

## ğŸ† è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ï¼

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ªæ˜Ÿæ ‡ï¼**
